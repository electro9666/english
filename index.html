<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!doctype html>
<html lang="ko-kr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>English</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/kfonts2.css" rel="stylesheet">
    <style>
/*         body { padding-top: 20px; } */
    </style>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
	<link rel="stylesheet" href="resources/icon.css">
	<link rel="stylesheet" href="resources/default.min.css">
	<link rel="stylesheet" href="resources/tomorrow.min.css">
	<style>
/* 		input{ */
/* 			height:28px; */
/* 		} */
		img {
			width:50px;
		}	
		.li2{
			overflow:hidden;
		}
		
		@media (max-width: 995px) {
		  #leftSideUl1 {
		    display: none;
		  }
		  #leftSideUl2 {
		    display: block;
		  }		  
		}
		@media (min-width: 996px) {
		  #leftSideUl1 {
		    display: block;
		  }
		  #leftSideUl2 {
		    display: none;
		  }
		}
		
		.mygroup{
			display:inline-block;
			border-radius:10px;
/* 			background-color:gray; */
			border:1px solid #BDBDBD;
			padding:10px;
		}
		
	</style>
  </head>
<body>
<div class="container">  

    <nav class="navbar navbar-default navbar-static-top navbar-inverse" role="navigation">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
<!--         <a class="navbar-brand" href="#">LOGO </a> -->
      </div>
     
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse navbar-ex1-collapse">
        <ul class="nav navbar-nav">
          <li class="active"><a href="javascript:void(0);" id="headerId">English</a></li>
          <li class=""><a href="javascript:void(0);" id="headerSentenceId"></a></li>
        </ul>
      </div><!-- /.navbar-collapse -->
    </nav>
    
    <div class="row">
		<div class="col-md-2" id="leftSideUl2">
			<a class="btn btn-info btn-xs" onclick="toggleLeftSide(this);" v="1">좌측메뉴 열기</a>
			<br>
			<br>
		</div>    
		<div class="col-md-2" id="leftSideUl1">
			<ul class="nav" id="leftSide" style="width:200px;">
<!-- 				<li>menu 1</li>
				<li>menu 2</li>
				<li>menu 3</li>
				<li>menu 4</li> -->
			</ul>
		</div>
		<div class="col-md-10">
		    <div id="mainContents" style="display:none;margin-left:20px;">
				<div id="mainControl">
					<div class="row">
						<div class="col-xs-12">
							<span class="mygroup">
								<a class="btn btn-info" onclick="goPrev(-1);"><span class="glyphicon glyphicon-step-backward"></span></a>
								<a class="btn btn-info" onclick="goPrev(1);"><span class="glyphicon glyphicon-step-forward"></span></a>
							</span>
							<span class="mygroup">
								<input type="text" id="repeatMax" value="1" style="width:40px;" onchange="repeatMaxUpdate(this);"/>
								<div class="btn-group">
									<button id="btn0" type="button" class="btn btn-primary btn-sm" onclick="makeLoop(this);">리스트 각 1회 반복</button>
									<button id="btn1" type="button" class="btn btn-default btn-sm" onclick="makeLoop1(this);">한개 무한 반복</button>
								</div>							
								<span id="repeatCount"></span>
							</span>
							<span class="mygroup">
								<label>speed :</label>
								<select id="speed" onchange="speedUpdate(this);" style="width:50px;">
									<option>0.25</option>
									<option>0.5</option>
									<option>0.75</option>
									<option selected="selected">1</option>
									<option>1.25</option>
									<option>1.5</option>
									<option>2</option>
								</select>							
							</span>
							<span class="mygroup">
								<label>시간 오차 :</label> 
<!-- 								앞 <input id="startMargin" type="text" style="width:50px;" value="-1" onchange="marginUpdate('start', this);"/>   -->
<!-- 								뒤 <input id="endMargin" type="text" style="width:50px;" value="+1" onchange="marginUpdate('end', this);"/></span> -->
								앞 <input id="startMargin" type="text" style="width:50px;" value="0" onchange="marginUpdate('start', this);"/>  
								뒤 <input id="endMargin" type="text" style="width:50px;" value="0" onchange="marginUpdate('end', this);"/></span>
							</span>
						</div>
					</div>
					<hr>
					<div class="row">
						<div class="col-xs-12">
							<div id="title"><span style='height:25px;font-size:20px;overflow-y:hidden;'>Title</span></div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-12">
							<input id="isRepeat" type="checkbox" checked onchange="repeatFlagUpdate(this);" style="width:20px;"/>
							<label for="isRepeat">구간반복</label>
							<span style="margin-left:20px;"></span>
							<span class="mygroup">
								<span id="startTimeFormat" style="width:30px;display:inline-block;">0:00</span>
								<input id="startTime" type="text" style="width:60px;" value="0" onchange="timeChange2('start', this);"/>
					            <span style="position:relative;display:inline-block;width:20px;">
					            	<a style="font-size:1em;position:absolute;top:-25px;" onclick="timeChange('start', 1);return false;">▲</a>
					            	<a style="font-size:1em;position:absolute;top:-10px;" onclick="timeChange('start', -1);return false;">▼</a>
					            </span>
					        </span>
				            <span>&nbsp;~&nbsp;</span>
				            <span class="mygroup">
					            <span id="endTimeFormat" style="width:30px;display:inline-block;">0:00</span>
					            <input id="endTime" type="text" style="width:60px;" value="0" onchange="timeChange2('end', this);"/>		
					            <span style="position:relative;display:inline-block;width:20px;">
					            	<a style="font-size:1em;position:absolute;top:-25px;" onclick="timeChange('end', 1);return false;">▲</a>
					            	<a style="font-size:1em;position:absolute;top:-10px;" onclick="timeChange('end', -1);return false;">▼</a>
					            </span>
					        </span>	
				            <span style="margin-left:50px;"></span>
				            <span class="mygroup">
				            	<span id="currentTimeFormat" style="width:100px;display:inline-block;">0:00</span>&nbsp;&nbsp;&nbsp;
				            </span>
						</div>
					</div>
				</div>
				<hr>
				<div id="sentence">Sentence</div>
				<div id="mainDiv">
					<div style="float:left;width:480px;height:410px;">
			            <div style="display:relative;">
				            <div id="parentIframe0" style="position:absolute;">
								<div id="youtubeIframe0"></div>
				            </div>
		<!--          			<div id="parentIframe1" style="position:absolute;top:300px;left:700px;"> -->
				            <div id="parentIframe1" style="position:absolute;">
								<div id="youtubeIframe1"></div>
				            </div>
				            <div id="retry" style="position:absolute;z-index:20;width:60px;height:20px;background-color:red;color:white;display:none">
				            </div>
						</div>
					</div>
				</div>
				<script id="player_template" type="text/x-handlebars-template">
		<div class="videoClass" seq="{{seq}}" id="video{{seq}}" videoId="{{videoId}}" startTime="{{startTime}}" endTime="{{endTime2}}" sentence="{{sentence}}" group="{{group}}" onclick="clickVideo(this);" style="float:left;margin:1px;padding:3px;">
			<img id="img{{seq}}" src="{{imgUrl}}" style="width:50px;height:38px;" />
		</div>
		</script>
		    </div>
		    <div id="mainContents2" style="display:none;">
			    <h3>개요</h3>
			    <p>Youtube script 내에서, 영어 문장들을 검색하여 <b>문장이 사용되는 상황</b>을 영상으로 학습한다.</p>
			    <p>도서 '영어회화 100일의 기적' 의 내용을 기반으로 한다.</p>
			    <p>크롤브라우저에서 정상 작동한다.</p>
<br><br>			   
<p>원리 :</p>
<ol>			    
<li>youtube에서 원하는 동영상 리스트ID를 찾는다. https://www.youtube.com/watch?v=uF8t0zDAJgo&list=<b>UUi7GJNg51C3jgmYTUwqoUXA</b></li>
<li>리스트ID를 이용해서 동영상 목록을 추출한다.
	<ul>
	<li>youtube api 이용 : https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=[리스트ID]&key=[KEY발급]&maxResults=50</li>
	<li>json결과를 파싱한다.</li>
	<li>목록이 50개를 넘을 경우(json결과에서 알 수 있다.) 51번째부터 다시 검색한다. (loop)</li>
	<li>리스트ID에 해당하는 동영상 목록을 txt로 보관한다. (현재 약 70개 txt)</li>
	</ul>
</li>
<li>동영상 목록 txt파일을 읽어들여서, 동영상 각각의 자막(사용자 입력, 자동생성)을 검색한다. (http://downsub.com 크롤링)
	<ul> 
	<li>youtube 사이트 자체를 크롤링하는 것보다 http://downsub.com 사이트를 크롤링 하는 것이 빠르다.</li>
	<li>크롤링 할때, 네트워크 속도로 시간지연이 발생하므로 여러 동영상을 멀티스레드로 처리한다.</li>
	<li>나중에 자막 텍스트 검색을 용이하게 하기 위해, 다운 받은 자막 txt을 읽어서 인덱싱 처리하여 txt로 저장한다.(동영상 전체 통문장, 구간별 구분 문장)
	<br>->현재 97000개의 txt 수집함.</li>
	<li>나중에 자막 텍스트 검색을 할때, 97000여개의 파일을 전부 읽어야 하는 IO 병목이 발생하므로, 1개의 summary.txt 파일로 optimize 하기
	<br>-> 파일명과 통문장으로만 이루어져 있어서, 해당하는 경우 상세자막txt에서 검색하도록 유도</li>
	</ul>
</li>
<li>검색
	<ul>
	<li>원하는 자막 텍스트를 검색한다.(정규식 이용)</li>
	<li>검색한 결과(동영상ID, 동영상 내 위치)를 *.js(json)로 추출한다.</li>
	<li>github.io를 이용하기 위해 *.js를 데이터db로 이용하였다.</li>
	</ul>
</li>
<li>화면
	<ul>
	<li>미리 검색하여 준비된 문장 리스트(좌측)를 선택시 해당하는 js파일을 읽어들여서 출력</li>
	<li>youtube player는 2개를 화면상 겹쳐놓고 api control을 통하여, 동영상 연속 재생시 끊김이 없도록 함</li>
	</ul> 
</li> 
</ol>			    

		    </div>
		</div>
	</div>
	<br>
	<div>
		<div id="disqus_thread"></div>
		<script>

		/**
		*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
		*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

		var disqus_config = function () {
		this.page.url = 'https://electro9666.github.io/english';
		this.page.identifier = 'english';
		};

		(function() { // DON'T EDIT BELOW THIS LINE
		var d = document, s = d.createElement('script');
		s.src = 'https://electro9666.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		(d.head || d.body).appendChild(s);
		})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	</div>
</div> <!-- container 끝 -->
	<script id="player_template2" type="text/x-handlebars-template">
			{{#each this}}
            	{{#each list}}
					{{#iff @../index @index}}
                		<li class='li2'><span>{{plus @../index}} <a href="?f={{this}}">{{this}}</a></span></li>
					{{else}}
						<li class='li2'>- <span><a href="?f={{this}}">{{this}}</a></span></li>
					{{/iff}}
            	{{/each}}
			{{/each}}
	</script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-1.12.3.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    
<!-- 	<script src="resources/jquery.min.js"></script> -->
	<script src="resources/highlight.min.js"></script>
	<script src="player.min.js"></script>
<!-- 	<script src="resources/iframe_api.js"></script> -->
	<script src="resources/handlebars-v4.0.10.js" type="text/javascript" charset="utf-8"></script>
	
</body>
</html>